<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8"> 
<title>A Usability Test for Dart: Static Site Generation. - Amit Prasad&#39;s Blog</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="Critiquing Dart when applying it to create low-maintainance, dynamic blogs, like this one, using Github Actions and Pages.">
<meta name="author" content="Amit Prasad">
<link rel="shortcut icon" href=""> 

    <link rel="stylesheet" type="text/css" href="/css/style.css">
    <link rel="stylesheet" type="text/css" href="/css/syntax.css">
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro:wght@300&family=Source+Sans+Pro&display=swap" rel="stylesheet">
    <script async defer data-website-id="ff352f3c-3995-4d85-b079-e3d41bf591a9" src="https://a.amitprasad.dev/u.js"></script>
</head>

<body>
    <script src="/js/theme.js"></script>
    <div class="container">
        
<div class="header">
    <h1>A Usability Test for Dart: Static Site Generation.</h1>
    <div class="subheader">
        <div class="post-details">
            <a class="image-container" href="https://github.com/AmitPr"><img src="https://avatars.githubusercontent.com/u/13373751?v=4" class="avatar" alt="Amit Prasad" /></a>
            <a href="https://github.com/AmitPr">Amit Prasad</a>
            <p class="subdued">/ August 10, 2021</p>
        </div>
        <div class="actions">
            <a href="/">Blog Home</a>
        </div>
    </div>
</div>
<article>
    <p>Subscription-based services are already everywhere, and monthly costs can start to add up. I didn't want to exacerbate the issue by adding monthly infrastructure costs for simple websites, such as this blog, to the mix. That's when I started to seek a way to create dynamic sites, or at least, sites that could appear to be dynamic, using free services alone.</p>
<h2>In Search of &quot;Dynamic Static Sites&quot;</h2>
<p>Many static file hosting platforms exist. They serve files out of a directory for no cost. However, since the files they serve are simple HTML/CSS/JS files, it's not possible to host pages that contain dynamic content. For example, the home page of this blog is somewhat dynamic, showing recent posts as they come in. On the other hand, posts themselves are static pages, not changing once they're published. To enable the creation of dynamic site generation, I turned to something that had been sitting right in front of me the whole time: <a href="https://github.com/features/actions">Github Actions</a>.  </p>
<p>Github Actions is a service that allows you to run a set of actions on your repositories. These actions can be anything from running a bash script to building, testing, and deploying your code. Taking Actions and then using it to run a static site generator is ideal for this project. Options for static site generators already exist namely Jekyll and Hugo. However, wanting to explore <a href="https://www.dart.dev/">Dart's</a> usability in CLI applications, I decided to write a custom static site generator. Finally, once generated files are generated in an output directory, it's possible to push that directory alone to a <code>gh-pages</code> branch for hosting. This method has further advantages, being able to refresh the site content at intervals as short as <a href="https://docs.github.com/en/actions/reference/events-that-trigger-workflows#scheduled-events">5 minutes</a>.  </p>
<h2>Dart in Github Actions</h2>
<p>For those unaware, <a href="https://www.dart.dev/">Dart</a> is a programming language created by Google. It's mainly used in tandem with <a href="https://flutter.dev/">Flutter</a>, a framework for building mobile apps. However, the simplicity of Dart suggests itself towards being a great scripting language for command-line applications. Getting dart set up and running on Github Actions machines was as easy as deploying a compiled binary to a machine of the same architecture that the binary was compiled on. No dependencies are required. However, in the end, I opted towards using the Dart SDK Action, as the real speedup wasn't worth the hassle of the compilation step (At least in this case).  </p>
<p>Developing the <a href="https://github.com/AmitPr/blog_gen">generator for this site</a> was a great learning experience, however, I can't say I'm a fan of the way that various aspects of this project work in Dart. Firstly is the mess that is the file path system in the built-in implementation. Dart's <code>FileSystemEntity</code> objects are notoriously annoying to work with, and instead one has to resort to using <a href="https://pub.dev/packages/path">package:path</a>. <code>package:path</code> <em>does</em> clean up many of the problems, but makes one beg to ask why the core SDK doesn't contain such an API for ease of use and more seamless functionality.</p>
<h3>File names aren't directly accessible</h3>
<div class="highlight"><pre><span></span><code><span class="c1">//Without package:path</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="n">fileName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fileObject</span><span class="p">.</span><span class="n">uri</span><span class="p">.</span><span class="n">pathSegments</span><span class="p">.</span><span class="n">last</span><span class="p">;</span><span class="w"></span>
<span class="c1">//With package:path</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="n">fileName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">path</span><span class="p">.</span><span class="n">basename</span><span class="p">(</span><span class="n">fileObject</span><span class="p">.</span><span class="n">path</span><span class="p">)</span><span class="w"></span>
</code></pre></div>
<h3>There isn't any way to easily create a path from two segments.</h3>
<div class="highlight"><pre><span></span><code><span class="c1">//Without package:path</span><span class="w"></span>
<span class="c1">//Fails when config.outputDirectory is a multi-segmented path.</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="n">targetPath</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Uri</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="nl">pathSegments:</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">        </span><span class="n">config</span><span class="p">.</span><span class="n">outputDirectory</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="p">...</span><span class="n">entity</span><span class="p">.</span><span class="n">uri</span><span class="p">.</span><span class="n">pathSegments</span><span class="p">.</span><span class="n">sublist</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"></span>
<span class="w">    </span><span class="p">],</span><span class="w"></span>
<span class="p">);</span><span class="w"></span>
<span class="c1">//With package:path</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">path</span><span class="p">.</span><span class="n">Context</span><span class="p">(</span><span class="nl">current:</span><span class="w"> </span><span class="n">contentDirectory</span><span class="p">.</span><span class="n">absolute</span><span class="p">.</span><span class="n">path</span><span class="p">);</span><span class="w"> </span><span class="c1">//Set and used earlier</span><span class="w"></span>
<span class="kd">var</span><span class="w"> </span><span class="n">targetPath</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">path</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">config</span><span class="p">.</span><span class="n">outputDirectory</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">relative</span><span class="p">(</span><span class="n">fileObject</span><span class="p">.</span><span class="n">absolute</span><span class="p">.</span><span class="n">path</span><span class="p">));</span><span class="w"></span>
</code></pre></div>
<p>Still not nearly as pretty as I would like, but a huge improvement, especially considering it doesn't fail in non-trivial cases. The point is that in my (fairly limited) experience, the built-in API is lacking in many ways. Take this with a grain of salt, I'm not a Dart expert, but as far as I can see, there isn't a much better way of going about things without relying on a non-core library.  </p>
<p>The other <em>major</em> issue is the <a href="https://github.com/dart-lang/sdk/issues/28617">lack of support for cross-compilation</a> in the SDK. This means that if you want to run the compiler on a machine with a different architecture (or operating system) than the one you're targeting, the compiled binary won't be able to be run on the target machine. For more information, check out the linked Github issue.  </p>
<p>Other more minor problems include limited documentation and support in the <a href="https://pub.dev/packages/markdown">markdown</a> and <a href="https://pub.dev/packages/jinja">jinja</a> packages, but none of this hindered the quality and ease of use of the generator.  </p>
<p>Reflecting on my thoughts, I'm not sure whether I would choose to create a static site generator in Dart if I were to start over. I'm going to stick with using and building upon the <a href="https://github.com/AmitPr/blog_gen">base that I have right now</a>, and I'm excited to see how Dart improves in the future.  </p>

</article>
<div class="footer">
    <a href="/" style="text-decoration: none;">← </a><a href="/">Check out more articles</a>
</div>

    </div>
</body>

</html>